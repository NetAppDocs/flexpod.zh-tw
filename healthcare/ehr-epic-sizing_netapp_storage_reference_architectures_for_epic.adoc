---
sidebar: sidebar 
permalink: healthcare/ehr-epic-sizing_netapp_storage_reference_architectures_for_epic.html 
keywords: storage, reference, architecture, epic, lun, small, medium, larger, configuration 
summary: 適當的儲存架構可視整體資料庫大小和IOPS總計而定。效能不只是唯一的考量因素、您可能會根據其他客戶需求決定使用較大的節點數。 
---
= Epic的NetApp儲存參考架構
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


適當的儲存架構可視整體資料庫大小和IOPS總計而定。效能不只是唯一的考量因素、您可能會根據其他客戶需求決定使用較大的節點數。

根據Epic軟體環境的儲存需求、NetApp有三種參考架構、以環境規模為基礎。Epic需要使用NetApp規模調整方法來適當調整NetApp儲存系統的規模、以便在Epic環境中使用。如需量化效能要求與規模調整指引、請參閱NetApp https://fieldportal.netapp.com/?oparams=68786["TR-3930i：《NetApp Epic規模調整準則》（NetApp Sizing Guidelines for Epic）"^]。若要檢視本文件、必須存取NetApp Field Portal。

此處列出的架構是設計的起點。工作負載必須在SPM工具中驗證磁碟數量和控制器使用率。與NetApp Epic團隊合作驗證所有設計。

所有Epic正式作業都部署在All Flash Array上。在本報告中、旋轉式磁碟所需的磁碟集區已整合至三個適用於All Flash Array的磁碟集區。在閱讀本節之前、您應檢閱Epic All Flash參考架構策略手冊、瞭解Epic儲存配置需求。

三種儲存參考架構如下：

* *小型*四節點架構、在正式作業中有兩個節點、在DR中有兩個節點（全球參考資料少於5萬）
* *中型*六節點架構、在正式作業中有四個節點、在DR中有兩個節點（超過5萬個全球參考資料）
* *大型* 12個以上節點架構、在正式作業中有6至10個節點（5M-10M全球參考資料）



NOTE: 整體參考資料=（讀取IOPS +（寫入作業每80秒寫入突發次數/ 45次）* 225。這些編號取自客戶專屬的Epic硬體組態指南。



== 儲存配置與LUN組態

滿足Epic高可用度（HA與備援需求）的第一步、是專為Epic軟體環境設計儲存配置。設計考量應包括將磁碟集區1與專屬高效能儲存設備上的磁碟集區2隔離。請參閱Epic All Flash參考架構策略手冊、瞭解每個磁碟集區中的工作負載。

將每個磁碟集區放在獨立的節點上、會建立隔離Epic正式作業和非正式作業工作負載所需的故障網域。每個節點使用一個Aggregate、可將磁碟使用率和Aggregate關聯性最大化、以提供更好的效能。此設計也能利用Aggregate層級的重複資料刪除技術、將儲存效率最大化。

由於Epic可讓儲存資源共享以滿足非正式作業需求、因此儲存系統通常可同時滿足Clarity伺服器和正式作業服務的儲存需求、例如虛擬桌面基礎架構（VDI）、CIFS及其他企業功能。

Epic資料庫儲存配置建議文件針對每個資料庫的LUN大小和數量提供建議。這些建議可能需要根據您的環境進行調整。請務必在Epic支援下檢閱這些建議、並最終確定LUN數量和LUN大小。

[NOTE]
====
NetApp建議從較大大小的LUN開始著手、因為LUN本身的大小並不需要支付儲存成本。為了便於操作、請確定LUN數量和初始大小在3年後可大增至超出預期需求。擴充LUN比新增LUN更容易管理。使用精簡配置的LUN和磁碟區時、儲存設備使用的空間會顯示在集合體中。

Epic需要透過FC將資料庫、日誌、應用程式或系統儲存設備、以LUN的形式呈現給資料庫伺服器。

====
Epic正式作業和Clarity使用每個Volume一個LUN。對於較大型的部署、NetApp建議Epic資料庫使用24到32個LUN。決定要使用的LUN數量的因素包括：

* 3年後Epic DB的整體規模。對於較大的DB、請判斷該作業系統（OS）的LUN大小上限、並確定您有足夠的LUN可擴充。例如、如果您需要60TB Epic資料庫、而作業系統LUN的容量上限為4TB、則需要24到32個LUN來提供擴充和擴充空間。


無論架構是小型、中型或大型：

* 支援簡單且不中斷營運的垂直擴充和橫向擴充。ONTAP您可以使用ONTAP 不中斷營運的方式來升級、新增或移除磁碟和節點。客戶可以從四個節點開始、移至六個節點、或在不中斷營運的情況下升級至較大的控制器。
* NetApp OnCommand Workflow Automation 解決方案工作流程可備份及更新Epic完整複製測試環境。此解決方案以整合式效率來簡化架構、並節省儲存容量。
* DR陰影資料庫伺服器是客戶營運不中斷策略的一部分（用於支援SRO功能、並可能設定為SRW執行個體）。因此、第三個儲存系統的放置與規模調整通常與正式作業資料庫儲存系統相同。
* 資料庫一致性需要考量。如果使用NetApp SnapMirror備份複本來維持營運不中斷、請參閱Epic文件《營運不中斷技術解決方案指南》。如需使用SnapMirror技術的相關資訊、請參閱 https://www.netapp.com/us/media/tr-3446.pdf["TR-3446：SnapMirror非同步概述與最佳實務做法指南"^]。
* 將正式作業與潛在的高效能工作負載隔離、是Epic的主要設計目標。儲存資源池是故障網域、必須隔離並保護工作負載效能。在一個故障叢集中的每個節點ONTAP 都是一個故障網域、可視為一個儲存資源池。


所有的平台均可執行Epic工作負載的完整功能集。ONTAP



== 小型組態：四節點參考架構、提供低於5百萬的全球參考資料（總IOPS最高約22萬）

小型參考架構是一個四節點架構、在正式作業中有兩個節點、在DR中有兩個節點、且全球參考資料少於5萬。此架構可供全球參考資料少於5萬的客戶使用。在這個規模下、不需要區分報告和清楚度。

NetApp提供獨特的多重傳輸協定支援、QoS以及在同一個叢集中建立故障網域的能力、您可以在單一HA配對上執行磁碟資源池1和磁碟Pool2的所有正式作業工作負載、並符合所有NetApp最佳實務做法和Epic的「高舒適度」評分要求。所有的磁碟集區1都會在節點1上執行、而所有的磁碟集區2都會在Pool2上執行。

由於能夠將同一個叢集內的工作負載隔離、並支援VMware多重傳輸協定、因此所有正式作業的Epic工作負載（正式作業、報告、Clarity、VMware、Citrix、ONTAP ONTAP CIFS和Epic相關工作負載）可在單一叢集的單一HA配對上執行。這項功能可讓您滿足Epic的所有要求（詳見Epic All Flash參考架構策略手冊）和所有NetApp最佳實務做法。基本上、Pool1是在節點prod-01上執行、Pool2則是在prod-02上執行、如下圖所示。NAS 1工作負載可透過NetApp多重傳輸協定NAS和SAN功能置於節點2上。

針對災難恢復、Epic DR Pool 3會在HA配對的兩個節點之間分割。EPIC DR可在節點DR-01上執行、DR服務則可在DR-02上執行。

NetApp SnapMirror或SnapVault 功能複寫可視工作負載需求進行設定。

image:ehr-epic-sizing_image2.png["錯誤：缺少圖形影像"]

從儲存設計與配置的觀點來看、下圖顯示正式作業資料庫的高層級儲存配置、以及構成Epic工作負載的其他架構。

image:ehr-epic-sizing_image3.png["錯誤：缺少圖形影像"]



== 中型組態：六節點參考架構、提供超過5萬個全球參考資料（總IOPS 22K-50K）

中型參考架構是一種六節點架構、在正式作業環境中有四個節點、在DR中有兩個節點、並提供5M-10M全域參考資料。

針對這種規模、《All Flash參考架構策略手冊》指出、您需要將Epic Report工作負載與Clarity區隔開、而且在正式作業中至少需要四個節點。

六節點架構是Epic環境中最常部署的架構。全球參考資料超過500、500、500、500、500、500、500、500、500、500、500、800、800、800、800、800、800。請參閱Epic All Flash參考架構策略手冊。

全球參考資料少於500、500、500、500、500、500、500、500、500、800、800、800、800、800、800、800、800、800、800、800、800、800、

* 從正式作業卸載備份歸檔程序
* 將所有測試環境從正式作業卸載


正式作業執行於節點prod-01。報告會在節點prod-02上執行、這是正式作業最新的Epic鏡射複本。例如支援、版本及版本驗證等測試環境、可從Epic正式作業、報告或DR複製。下圖顯示從正式作業環境製作的完整複本測試環境複本。

第二個HA配對用於正式作業服務儲存需求。這些工作負載包括Clarity資料庫伺服器（SQL或Oracle）、VMware、Hyperspace和CIFS的儲存設備。客戶可能擁有非Epic工作負載、可以新增至此架構的節點3和節點4、或是最好新增至同一個叢集中的個別HA配對。

SnapMirror技術用於將正式作業資料庫的儲存層級複寫至第二個HA配對。SnapMirror備份複本可用於在第二個儲存系統上建立NetApp FlexClone磁碟區、以供非正式作業環境使用、例如支援、發行和版本驗證。正式作業資料庫的儲存層級複本也可支援客戶實作其災難恢復策略。

或者、若要提高儲存效率、您可以從Report NetApp Snapshot複本備份建立完整測試複本、然後直接在節點2上執行。在此設計中、SnapMirror目的地複本不需要儲存在磁碟上。

image:ehr-epic-sizing_image4.png["錯誤：缺少圖形影像"]

下圖顯示六節點架構的儲存配置。

image:ehr-epic-sizing_image5.png["錯誤：缺少圖形影像"]



== 大型組態：參考架構、提供超過10萬個全域參考資料（超過50萬IOPS）

大型架構通常是一個十二個以上節點的架構、在正式作業中有六到十個節點、並有超過10萬個全域參考資料。對於大型Epic Production、Epic Report和Clarity部署、可放置在專屬的HA配對上、並在節點之間平均平衡儲存空間、如下圖所示。

較大的客戶有兩種選擇：

* 保留六節點架構、並使用AFF Ar4A700控制器。
* 在專屬AFF 的AreA300 HA配對上執行Epic正式作業、報告及DR。


您必須使用SPM來比較控制器使用率。此外、選擇控制器時、請考量機架空間和電力。

image:ehr-epic-sizing_image6.png["錯誤：缺少圖形影像"]

下圖顯示大型參考架構的儲存配置。

image:ehr-epic-sizing_image7.png["錯誤：缺少圖形影像"]
